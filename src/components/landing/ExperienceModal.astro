---
import type { HTMLAttributes } from "astro/types";
import Link from "../Link.astro";
import { Image } from "astro:assets";

type Props = HTMLAttributes<"div"> & {
  start: string;
  end: string;
  jobTitle: string;
  company: string;
  description: string;
  icon: ImageMetadata;
  modalId: string;
};

const { start, end, jobTitle, company, description, icon, modalId, ...props } =
  Astro.props;
---

<div class="modal-overlay" id={modalId} aria-hidden="true">
  <div
    class="modal-container"
    role="dialog"
    aria-modal="true"
    aria-labelledby={`title-${modalId}`}
  >
    <header class="modal-header px-4">
      <button class="modal-close-btn" data-modal-close aria-label="Close modal"
        >&times;</button
      >
      <div class="flex flex-col md:flex-row gap-2 w-full md:items-center">
        <div
          class="flex w-[40px] h-[40px] items-center justify-center shrink-0"
        >
          <Image
            src={icon}
            alt={company}
            class="w-full h-full object-cover"
            width={80}
            height={80}
          />
        </div>
        <div class="flex flex-col w-full">
          <div class="flex flex-col md:flex-row justify-between flex-grow">
            <p class="text-[18px] font-sans font-medium source-sans-3-bold">
              {jobTitle}
              <span class="source-serif-4-light-italic"> at </span>
              {company}
            </p>
            <p class="text-[15px] italic shrink-0">
              {start} - {end}
            </p>
          </div>
          <p class="text-[15px] font-sans font-light source-sans-3-light">
            {description}
          </p>
        </div>
      </div>
    </header>
    <main class="modal-content px-4 pb-4">
      <slot />
    </main>
  </div>
</div>

<style>
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    visibility: hidden;
    opacity: 0;
    transition:
      opacity 0.3s ease,
      visibility 0.3s ease;
    z-index: 1000;
  }

  .modal-overlay.is-open {
    visibility: visible;
    opacity: 1;
  }

  .modal-container {
    background-color: white;
    border-radius: 8px;
    width: 90%;
    max-width: 700px;
    max-height: 90vh;
    overflow-y: auto;
    transform: scale(0.9);
    transition: transform 0.3s ease;
  }

  .modal-overlay.is-open .modal-container {
    transform: scale(1);
  }

  .modal-header {
    display: flex;
    flex-direction: column;
    align-items: end;
    border-bottom: 1px solid #ddd;
    padding-bottom: 1rem;
    margin-bottom: 1rem;
  }

  .modal-close-btn {
    font-size: 2rem;
    background: none;
    border: none;
    cursor: pointer;
  }

  .modal-content :global(p) {
    font-size: 15px;
  }
  .modal-content :global(h3) {
    margin-bottom: 0px;
    margin-top: 8px;
  }
  .modal-content :global(ul) {
    font-size: 15px;
    color: "#222939";
    font-family: "Source Sans 3", sans-serif;
    font-optical-sizing: auto;
    font-weight: 300;
    font-style: normal;
    list-style-type: circle;
    margin-left: 10px;
  }
</style>
