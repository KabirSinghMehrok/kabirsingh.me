---
import type { HTMLAttributes } from "astro/types";
import Link from "../Link.astro";
import { Image } from "astro:assets";

type Props = HTMLAttributes<"div"> & {
  start: string;
  end: string;
  jobTitle: string;
  company: string;
  description: string;
  icon: ImageMetadata;
  modalId: string;
};

const { start, end, jobTitle, company, description, icon, modalId, ...props } =
  Astro.props;
---

<div
  class="fixed inset-0 w-full h-full bg-black/70 flex justify-center items-center invisible opacity-0 transition-[opacity,visibility] duration-300 ease-in-out z-[1000] modal-overlay"
  id={modalId}
  aria-hidden="true"
>
  <div
    class="bg-white rounded-lg w-[90%] max-w-[940px] max-h-[90vh] scale-90 transition-transform duration-300 ease-in-out modal-container"
    role="dialog"
    aria-modal="true"
    aria-labelledby={`title-${modalId}`}
  >
    <header
      class="relative flex flex-col items-end border-b border-[#ddd] pb-4 mb-4 px-4 modal-header"
    >
      <button
        class="absolute -top-8 -right-8 bg-white cursor-pointer modal-close-btn rounded-full w-8 h-8 flex flex-col items-center justify-center"
        data-modal-close
        aria-label="Close modal"><img src="/public/cross.svg" /></button
      >
      <div class="flex flex-col md:flex-row gap-4 w-full md:items-center mt-4">
        <div
          class="flex w-[60px] h-[60px] items-center justify-center shrink-0 border border-[#cfcfcf] rounded-md p-3"
          style="box-shadow: rgba(99, 99, 99, 0.2) 0px 0.6px 2.7px 0px;"
        >
          <Image
            src={icon}
            alt={company}
            class="w-full h-full object-cover"
            width={80}
            height={80}
          />
        </div>
        <div class="flex flex-col w-full">
          <div class="flex flex-col md:flex-row justify-between flex-grow">
            <p class="text-[18px] font-sans font-medium source-serif-4-regular">
              {jobTitle}
              <span class="source-serif-4-light-italic"> at </span>
              {company}
            </p>
            <p class="text-[15px] italic shrink-0">
              {start} - {end}
            </p>
          </div>
          <p class="text-[15px] font-sans font-light source-sans-3-light">
            {description}
          </p>
        </div>
      </div>
    </header>
    <main class="px-4 pb-4 modal-content overflow-y-auto">
      <slot />
    </main>
  </div>
</div>

<style>
  .modal-overlay.is-open {
    visibility: visible;
    opacity: 1;
  }

  .modal-overlay.is-open .modal-container {
    transform: scale(1);
  }

  .modal-content :global(p) {
    font-size: 15px;
  }
  .modal-content :global(h3) {
    margin-bottom: 0px;
    margin-top: 8px;
  }
  .modal-content :global(ul) {
    font-size: 15px;
    color: "#222939";
    font-family: "Source Sans 3", sans-serif;
    font-optical-sizing: auto;
    font-weight: 300;
    font-style: normal;
    list-style-type: circle;
    margin-left: 10px;
  }
</style>
